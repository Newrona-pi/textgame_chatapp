# 4択会話システム - 使用方法ガイド

## 🎯 概要

このアプリは、AIが動的に生成するメッセージと4択の選択肢を使って、キャラクターと永続的な会話を楽しむことができるシステムです。

## 🚀 起動方法

### 1. 必要な設定

#### OpenAI APIキーの設定
```bash
# backend/.env ファイルを作成
OPENAI_API_KEY=your_openai_api_key_here
```

#### 依存関係のインストール
```bash
# バックエンド
cd backend
pip install openai python-dotenv flask flask-cors

# フロントエンド
cd frontend
npm install
```

### 2. サーバー起動

#### バックエンドサーバー
```bash
cd backend
python src/main.py
```
→ http://localhost:5000 で起動

#### フロントエンドサーバー
```bash
cd frontend
npm run dev
```
→ http://localhost:5173 で起動

## 🎮 使用方法

### 基本的な流れ

1. **アプリにアクセス**
   - ブラウザで http://localhost:5173 を開く

2. **会話開始**
   - 「会話を始める」ボタンをクリック
   - AIがキャラクターの質問と4つの選択肢を生成

3. **選択肢を選ぶ**
   - 表示された4つの選択肢から好きなものをクリック
   - ユーザーの選択に基づいて次の会話が生成される

4. **会話継続**
   - 選択→返答→新しい選択肢のサイクルが永続的に続く
   - 会話履歴が保持され、一貫性のある対話が可能

5. **会話リセット**
   - 「会話をリセット」ボタンで新しい会話を開始

### 画面の見方

#### 左上: 日付・時刻表示
- 現在の日付（YYYY/M/D/WeekdayName形式）
- リアルタイム時刻（HH:MM:SS）
- 可愛いフォントで表示

#### 中央: キャラクター
- キャラクター画像が表示
- ホバー効果でわずかに拡大

#### 下部: メッセージボックス
- キャラクター名（♪マーク付き）
- メッセージテキスト
- 4択選択肢（2x2グリッド）
- アクションボタン

## 🎨 UI特徴

### 4択選択肢
- **レイアウト**: 2x2のグリッド配置
- **デザイン**: ピンクの枠線、ホバー効果
- **レスポンシブ**: モバイルでは縦1列に変更

### 日時表示
- **位置**: 画面左上固定
- **背景**: 半透明の白背景
- **フォント**: 時刻部分にM PLUS Rounded 1c使用

### アニメーション
- **ローディング**: 「メッセージを考えています...」
- **ホバー効果**: ボタンの色変化と浮き上がり
- **キャラクター**: ホバー時の拡大効果

## 🔧 カスタマイズ

### キャラクター変更
```csv
# backend/src/characters.csv を編集
character_id,name,age,personality,tone,setting,background
```

### メッセージスタイル変更
```python
# character_service.py の _build_initial_prompt() を編集
```

### UI色変更
```css
/* App.css の .option-button を編集 */
.option-button {
  border: 2px solid #FF69B4; /* ピンク */
}
```

## 🚨 トラブルシューティング

### よくある問題

#### 1. 「メッセージ生成エラー」が表示される
- OpenAI APIキーが正しく設定されているか確認
- `.env`ファイルがbackendフォルダにあるか確認
- APIキーの有効性を確認

#### 2. 選択肢が表示されない
- バックエンドサーバーが起動しているか確認
- ブラウザの開発者ツールでエラーを確認
- APIレスポンスの形式を確認

#### 3. 画像が表示されない
- `frontend/src/assets/`に画像ファイルがあるか確認
- `App.jsx`のimport文のファイル名が正しいか確認

#### 4. 日時が表示されない
- `App.css`の`.datetime-display`スタイルが適用されているか確認
- ブラウザのキャッシュをクリア

### デバッグ方法

#### ブラウザ開発者ツール
```javascript
// コンソールでエラーを確認
console.log('現在の状態:', {message, options, isDialogueMode});
```

#### サーバーログ
```bash
# バックエンドのターミナルでログを確認
# APIリクエスト/レスポンスが表示される
```

## 📱 モバイル対応

### レスポンシブ機能
- **画面サイズ自動調整**: 768px以下でモバイルレイアウト
- **選択肢配置**: デスクトップ2x2 → モバイル1列
- **フォントサイズ**: 自動調整
- **タッチ操作**: ボタンのタッチ対応

### モバイル最適化
- **メッセージボックス**: 画面幅95%に調整
- **日時表示**: サイズとパディング縮小
- **キャラクター画像**: サイズ自動調整

---

**ヒント**: 会話を楽しむために、様々な選択肢を試してキャラクターの反応を見てみてください！AIが毎回異なる会話を生成するので、同じ選択肢でも違った展開が楽しめます。

